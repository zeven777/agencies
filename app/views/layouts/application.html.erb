<!DOCTYPE html>
<html>
<head>
  <title>Agencytest</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <script src= "https://ajax.googleapis.com/ajax/libs/angularjs/1.3.15/angular.min.js"></script>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <script>
  var app = angular.module('myApp', []);
  var myArreglo = new Array();
  var datos = new Array();


  function dataService ($http, $q) {
    return {
        getAll: getAll
    }

    function getAll () {
        var defered = $q.defer();
        var promise = defered.promise;

        $http.get("https://stormy-castle-4138.herokuapp.com/agencies.json")
            .success(function(response) {
                defered.resolve(response);
            })
            .error(function(err) {
                defered.reject(err)
            });

        return promise;
    }
  }

  app.controller("AgencyController", ["$scope", function(dataService){
  //function AgencyController (dataService) {
    dataService
        .getAll()
        .then(function(response) {
            $scope.months = response;
            console.log(response);
        })
        .catch(function(err) {
            // Tratar el error
        });
    
  }]);

  </script>
  <%= csrf_meta_tags %>
</head>
<body>
  <%= yield %>
</body>
</html>
